

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Advanced topics &mdash; saspy 4.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="saspy 4.1.0 documentation" href="index.html"/>
        <link rel="next" title="Contributing new methods" href="adding-procedures.html"/>
        <link rel="prev" title="API Reference" href="api.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> saspy
          

          
          </a>

          
            
            
              <div class="version">
                4.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#using-batch-mode">Using Batch mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#prompting">Prompting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#moving-values-between-python-variables-and-sas-macro-variables">Moving values between Python Variables and SAS Macro Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#slow-performance-loading-sas-data-into-a-pandas-dataframe-to-df-sd2df">Slow performance loading SAS data into a Pandas DataFrame ( to_df(), sd2df() )</a></li>
<li class="toctree-l2"><a class="reference internal" href="#slow-performance-loading-a-dataframe-into-a-sas-data-set-df2sd">Slow performance loading a DataFrame into a SAS data set; df2sd()</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-proc-iomoperate-to-find-object-spawner-hosts-and-workspace-server-ports">Using Proc iomoperate to find Object Spawner hosts and Workspace Server ports</a></li>
<li class="toctree-l2"><a class="reference internal" href="#disconnecting-from-an-iom-session-and-reconnecting-back-to-it">Disconnecting from an IOM session and reconnecting back to it.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-grid-option-sets-to-have-saspy-run-on-a-specific-queue">Configuring Grid Option Sets to have saspy run on a specific Queue.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dates-times-and-datetimes-oh-my">Dates, Times and Datetimes, Oh my!</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-sd2df-and-df2sd-techniques">Advanced sd2df and df2sd techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="#automatic-checking-for-error-in-the-log-and-the-warnings-module">Automatic checking for ERROR: in the LOG and the warnings module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#saspy-logger-from-logging-logger-as-of-v3-7-5">saspy.logger from logging.logger as of V3.7.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sassession-object-as-a-context-manager-as-of-v3-7-5">SASsession object as a context manager as of V3.7.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jupyter-magics">Jupyter magics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="adding-procedures.html">Contributing new methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="limitations.html">Limitations, restrictions and work arounds</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">saspy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Advanced topics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/advanced-topics.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="advanced-topics">
<h1>Advanced topics<a class="headerlink" href="#advanced-topics" title="Permalink to this headline">¶</a></h1>
<p>In this chapter we will explore more detailed explanations of specific functionality.</p>
<div class="section" id="using-batch-mode">
<h2>Using Batch mode<a class="headerlink" href="#using-batch-mode" title="Permalink to this headline">¶</a></h2>
<p>Batch mode is meant to be used when you want to automate your code as Python scripts.</p>
<p>In batch mode, any method that would normally display results, returns a Python dictionary
instead and with two keys; LOG, LST. This is the same as how the submit() method works
normally.</p>
<p>The LOG has the SAS Log and the LST contains the results. You will likely want to set
the results parameter to HTML (this was originally the default instead of Pandas). When
you set the results to HTML, not only are plots and graphs in HTML, but also tabular results
too.</p>
<p>The example below shows the contents of a Python script that runs a linear regression and
writes all the results to a directory. You can access the directory with a web browser to
view these results by clicking on them. Adjust the filesystem path below and you should
be able to run this code yourself.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/python3.5</span>

<span class="kn">import</span> <span class="nn">saspy</span>
<span class="n">sas</span> <span class="o">=</span> <span class="n">saspy</span><span class="o">.</span><span class="n">SASsession</span><span class="p">(</span><span class="n">results</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">)</span>

<span class="n">cars</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">sasdata</span><span class="p">(</span><span class="s1">&#39;cars&#39;</span><span class="p">,</span> <span class="n">libref</span><span class="o">=</span><span class="s1">&#39;sashelp&#39;</span><span class="p">)</span>

<span class="n">sas</span><span class="o">.</span><span class="n">set_batch</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

<span class="n">stat</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">sasstat</span><span class="p">()</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">stat</span><span class="o">.</span><span class="n">reg</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;horsepower = Cylinders EngineSize&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">cars</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">_names</span><span class="p">)):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="fm">__getattr__</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">_names</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">out1</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Public</span><span class="se">\\</span><span class="s2">saspy_demo</span><span class="se">\\</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">res</span><span class="o">.</span><span class="n">_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.html&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w+b&#39;</span><span class="p">)</span>
        <span class="n">out1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;LST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="n">out1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out1</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Public</span><span class="se">\\</span><span class="s2">saspy_demo</span><span class="se">\\</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">res</span><span class="o">.</span><span class="n">_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.log&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w+b&#39;</span><span class="p">)</span>
        <span class="n">out1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="n">out1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The URL to see these results is: <a class="reference external" href="file:///C:/Public/saspy_demo/">file:///C:/Public/saspy_demo/</a>. Of course, you can
imagine integrating the results into nicer web page for reporting, but with nothing more
than this few lines of code, you can have the results updated and refreshed by just
re-running the script.</p>
</div>
<div class="section" id="prompting">
<h2>Prompting<a class="headerlink" href="#prompting" title="Permalink to this headline">¶</a></h2>
<p>There are two types of prompting that can be performed; meaning to stop processing and
prompt the user for input and then resume processing.</p>
<p>The first type of prompting is performed implicity. When you run the
SASsession() method, if any required parameters for the chosen connection method
were not specified in the configuration definition (in sascfg_personal.py), processing is interrupted
so that the user can be prompted for the missing parameters. In addition, when there
is more than one configuration definition in SAS_config_names, and cfgname is not
specified in the SASsession() method (or an invalid name is specified), the user will
be prompted to select the configuration definition to use.</p>
<p>The other kind of prompting is prompting that you control. The submit() method,
and the saslib() methods both take an optional prompt parameter. This parameter
is how you request to have the user prompted for input at run time. This option
is used in conjunction with SAS macro variable names that you enter in the SAS
code or options for the method.</p>
<p>The prompt parameter takes a Python dictionary. The keys are the SAS macro variable
names and the values are True or False. The Boolean value indicates whether it
is to hide what the user types in or not. It also controls whether the macro variables
stay available to the SAS session or if they are deleted after running that code.</p>
<p>You will be prompted for the values of your keys, and those values will be assigned
to the SAS macro variables for you in SAS. When your code runs, the macro variables will be
resolved. If you specified <code class="docutils literal"><span class="pre">True</span></code>, then the value the user types is not displayed,
nor is the macro variable displayed in the SAS log, and the macro variable is deleted
from SAS so that it is not accessible after that code submission. For <code class="docutils literal"><span class="pre">False</span></code>, the
user can see the value as it is type, the macro variables can be seen in the SAS log
and the variables remain available in that SAS session for later code submissions.</p>
<p>The following are examples of how to use prompting in your programs. The first example
uses the saslib() method to assign a libref to a third-party database. This is a
common issue&#8211;the user needs to specify credentials, but you do not want to include
user IDs and passwords in your programs. Prompting enables the user to provide
credentials at runtime.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">sas</span><span class="o">.</span><span class="n">saslib</span><span class="p">(</span><span class="s1">&#39;Tera&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;Teradata&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="s1">&#39;user=&amp;user pw=&amp;mypw server=teracop1&#39;</span><span class="p">,</span>
           <span class="n">prompt</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s1">&#39;mypw&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
</pre></div>
</div>
<p>At runtime, the user is prompted for user and password and sees something like the
following when entering values (the user ID is visible and the password is obscured):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Please</span> <span class="n">enter</span> <span class="n">value</span> <span class="k">for</span> <span class="n">macro</span> <span class="n">variable</span> <span class="n">user</span> <span class="n">sasdemo</span>
<span class="n">Please</span> <span class="n">enter</span> <span class="n">value</span> <span class="k">for</span> <span class="n">macro</span> <span class="n">variable</span> <span class="n">mypw</span> <span class="o">........</span>
</pre></div>
</div>
<p>Another example might be that you have code that creates a table, but you want to let
the user choose the table name as well as the name of the column and a hidden value
to assign to it. By specifing <code class="docutils literal"><span class="pre">False</span></code>, the user can see the value, and the SAS log
shows the non-hidden macro mariables, followed by another code submission that uses
the previously defined non-hidden variables&#8211;which are still available.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">ll</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">data &amp;dsname;</span>
<span class="s1">  do &amp;var1=&quot;&amp;pw&quot;;</span>
<span class="s1">    output;</span>
<span class="s1">  end;</span>
<span class="s1">run;</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;var1&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s1">&#39;pw&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s1">&#39;dsname&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>Please enter value for macro variable var1 MyColumnName
Please enter value for macro variable hidden ........
Please enter value for macro variable dsname TestTable1

print(ll[&#39;LOG&#39;])

103  ods listing close;ods html5 (id=saspy_internal) file=stdout options(bitmap_mode=&#39;inline&#39;) device=svg; ods graphics on /
103! outputfmt=png;
NOTE: Writing HTML5(SASPY_INTERNAL) Body file: STDOUT
104
105  options nosource nonotes;
108  %let var1=MyColumnName;
109  %let dsname=TestTable1;
110
111  data &amp;dsname;
112    do &amp;var1=&quot;&amp;hidden&quot;;
113      output;
114    end;
115  run;
NOTE: The data set WORK.TESTTABLE1 has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds

116
117  proc print data=&amp;dsname;
118  run;
NOTE: There were 1 observations read from the data set WORK.TESTTABLE1.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds

119
120  options nosource nonotes;
123
124  ods html5 (id=saspy_internal) close;ods listing;


HTML(sas.submit(&#39;&#39;&#39;
proc print data=&amp;dsname;
run;
&#39;&#39;&#39;)[&#39;LST&#39;])

Obs     MyColumnName
1       cant see me
</pre></div>
</div>
<p>That is a highly contrived example, but you get the idea. You can prompt users
at runtime for values you want to use in the code, and those values can be
kept around and used later in the code, or hidden and inaccessible afterward.</p>
</div>
<div class="section" id="moving-values-between-python-variables-and-sas-macro-variables">
<h2>Moving values between Python Variables and SAS Macro Variables<a class="headerlink" href="#moving-values-between-python-variables-and-sas-macro-variables" title="Permalink to this headline">¶</a></h2>
<p>There are two methods on the SASsession object you can use to transfer values between Python and SAS.
symget() and symput(). To get a value from a SAS Macro Variable and assign it to a Python variable you
just call symget with the name of the macro variable.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">py_var</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">symget</span><span class="p">(</span><span class="n">sas_macro_var</span><span class="p">)</span>
</pre></div>
</div>
<p>To set the value of a SAS Macro Variable using the value of a Python variable, use symput() specifying
the macro variable name, and providing the python variable continaing the value.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">py_var</span> <span class="o">=</span> <span class="n">some_value</span>
<span class="n">sas</span><span class="o">.</span><span class="n">symput</span><span class="p">(</span><span class="n">sas_macro_var</span><span class="p">,</span> <span class="n">py_var</span><span class="p">)</span>
</pre></div>
</div>
<p>For a much better set of examples and use cases with these two methods, check out the notebook in saspy-examples:
<a class="reference external" href="https://github.com/sassoftware/saspy-examples/blob/master/SAS_contrib/Using_SYMGET_and_SYMPUT.ipynb">https://github.com/sassoftware/saspy-examples/blob/master/SAS_contrib/Using_SYMGET_and_SYMPUT.ipynb</a></p>
</div>
<div class="section" id="slow-performance-loading-sas-data-into-a-pandas-dataframe-to-df-sd2df">
<h2>Slow performance loading SAS data into a Pandas DataFrame ( to_df(), sd2df() )<a class="headerlink" href="#slow-performance-loading-sas-data-into-a-pandas-dataframe-to-df-sd2df" title="Permalink to this headline">¶</a></h2>
<p>UPDATE!!! As of Version 3.7.0, the MEMORY (default) version of sasdata2dataframe now outperforms all of the various methods.
So, effectively, the CSV and DISK versions are no longer needed (though, of course they are still there; can&#8217;t break your code).
But, MEMORY and DISK are now actually one in the same. They do not use disk space on the client side, rather stream the data
directly into pandas read_csv() method. Therfore, &#8216;tempfile&#8217; and &#8216;tempkeep&#8217; no longer have meaning and are ignored. But, you
can now use kwargs for pandas on the MEM version like you could on the DISK version (advanced feature, you probably don&#8217;t use anyway).
For the CSV version, the same is true that the CSV file being streamed over from the SAS session is feed directly into read_csv()
so no file is created on the client side; except for the Local IOM case. In this one case, it&#8217;s still faster to have the csv file SAS
wrote out locally directly read by pandas. And that one case may be slightly faster then MEM or DISK, but not by much if so. Performance
result vary, so it depends. But, in general, you can simple use sd2df() in all cases and have good performance instead of needing the
CSV and DISK versions. So now you can ignore the rest of this section :)
ENDUPDATE!!!</p>
<p>Transferring data from SAS into Python (and the reverse) has been in this module from the beginning. As usage of this has grown,
larger sized data sets have been shown to be much slower to load and consume lots of memory. After investigations, this has to do with
trying to build out the dataframes &#8216;in memory&#8217;. This works fine up to a point, but the memory consumption and CPU usage doesn&#8217;t scale.</p>
<p>I&#8217;ve made enhancements to the algorithm, so it will work, as opposed to run indefinitely consuming too many resources, but it is still
too slow.</p>
<p>So, I&#8217;ve added a second method for doing this, using a CSV file as an intermediate store, then using the Pandas read_csv() method to create
the dataframe. This performs significantly faster, as it doesn&#8217;t consume memory for storing the data in python objects. The read_csv() method
is much faster than trying to append data in memory as it&#8217;s streamed into python from SAS.</p>
<p>There is now a parameter for these methods to specify which method to use: method=[&#8216;MEMORY&#8217; | &#8216;CSV&#8217;].
The default is still MEMORY. But you can specify CSV to use this new method: to_df(method=&#8217;CSV&#8217;), sd2df(method=&#8217;CSV&#8217;).</p>
<p>There are also alias routines which specify this for you: to_df_CSV() and sd2df_CSV().</p>
<p>Another optimization with this is when saspy and SAS are on the same machine. When this is the case, there is no transfer required.
The CSV file written by SAS is the file specified in read_csv(). For remote connections, the CSV file still needs to be transferred from
SAS to saspy and written to disk locally for the read_csv() method. This is still significantly faster for larger data.</p>
<p>Starting in saspy version 3.1.7, there is now a third method for sd2df; &#8216;DISK&#8217;. method=[&#8216;MEMORY&#8217; | &#8216;CSV&#8217; | &#8216;DISK&#8217;], or the aliases
to_df_DISK() and sd2df_DISK(). This mehtod uses the same code as MEMORY to get the data, but stores it in a file, like the CSV method, so
that reading it into a dataframe w/ Pandas performs much better. This method allows better control over things like embedded delimiters
and newlines, which Pandas can have parsing problem with reading CSV file created from proc export.</p>
</div>
<div class="section" id="slow-performance-loading-a-dataframe-into-a-sas-data-set-df2sd">
<h2>Slow performance loading a DataFrame into a SAS data set; df2sd()<a class="headerlink" href="#slow-performance-loading-a-dataframe-into-a-sas-data-set-df2sd" title="Permalink to this headline">¶</a></h2>
<p>df2sd (dataframe2sasdata) has two main steps, which were both done internal to the method. The second is transferring the data
but the first is figureing out the necessary metadata to be able to correctly define the SAS Data Set being created. This requires
identifying each column: it&#8217;s name, data type, length (this is the crux here), required conversion type (date/time/datetime), ...</p>
<p>This metadata gathering step becomes slower the larger the data gets, only due to character columns. In SAS, I have to declare the
length in bytes, of the SAS session encoding, that the column requires to fit the data. DataFrames have no metadata about how long
any char columns are (they aren&#8217;t char they are simply objects), so there&#8217;s no way to know how long to declare these in SAS, other
than to apply a lanbda len function to each of these columns (transcoding to bytes in the SAS encoding), and taking the max value,
for each char column. That&#8217;s all cute and nifty when the data doesn&#8217;t have millions of rows and hunfreds of char columns. So, as
of V3.6.0, I&#8217;ve made some changes to accomodate data this large.</p>
<p>First, I&#8217;ve pulled the char length calculation code out of df2sd, into a public method (df_char_lengths()). df2sd calls this itself,
by default, so it&#8217;s the same as before if you do nothing new. But, you can call that method, with a number of different paramerters
that can make it faster; calculate char length, not encoded byte lenghts (which is faster), and just multiply by the BPC (bytes per
char) of the SAS encoding (which I have defaults for or you can override and probvide your own BPC). This routine returns a dict with
each char column name and the length. df2sd can be passed these same parameters, so when it calls this method, it can do the same thing.</p>
<p>df2sd also can now take the dict that this routine will produce, or just a dict you code up with the lengths, skipping this whole
disconvery process all together. So, you can code the lengths yourself, have df2sd do it but with some better performance, or call
the method to calculate them and pass in that dict. This is good when you run df2sd on the same data more then once; figure out the
lengths once and just pass in the dict all the times and never have to specd time recalculating.</p>
<p>Here are a few example cases showing this.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># For this case SAS is running in UTF-8</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span>
<span class="n">Access</span> <span class="n">Method</span>         <span class="o">=</span> <span class="n">IOM</span>
<span class="n">SAS</span> <span class="n">Config</span> <span class="n">name</span>       <span class="o">=</span> <span class="n">iomj</span>
<span class="n">SAS</span> <span class="n">Config</span> <span class="nb">file</span>       <span class="o">=</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">tom</span><span class="o">/</span><span class="n">github</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">sascfg_personal</span><span class="o">.</span><span class="n">py</span>
<span class="n">WORK</span> <span class="n">Path</span>             <span class="o">=</span> <span class="o">/</span><span class="n">sastmp</span><span class="o">/</span><span class="n">SAS_work528B00001B2F_tom64</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="n">SAS_work8B1F00001B2F_tom64</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span>
<span class="n">SAS</span> <span class="n">Version</span>           <span class="o">=</span> <span class="mf">9.04</span><span class="o">.</span><span class="mo">01</span><span class="n">M4D11092016</span>
<span class="n">SASPy</span> <span class="n">Version</span>         <span class="o">=</span> <span class="mf">3.6</span><span class="o">.</span><span class="mi">0</span>
<span class="n">Teach</span> <span class="n">me</span> <span class="n">SAS</span>          <span class="o">=</span> <span class="bp">False</span>
<span class="n">Batch</span>                 <span class="o">=</span> <span class="bp">False</span>
<span class="n">Results</span>               <span class="o">=</span> <span class="n">Pandas</span>
<span class="n">SAS</span> <span class="n">Session</span> <span class="n">Encoding</span>  <span class="o">=</span> <span class="n">utf</span><span class="o">-</span><span class="mi">8</span>
<span class="n">Python</span> <span class="n">Encoding</span> <span class="n">value</span> <span class="o">=</span> <span class="n">utf_8</span>
<span class="n">SAS</span> <span class="n">process</span> <span class="n">Pid</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">6959</span>

<span class="c1"># Create a dataframe of all CHAR columns from the cars dataset</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">cars</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">sasdata</span><span class="p">(</span><span class="s1">&#39;cars&#39;</span><span class="p">,</span><span class="s1">&#39;sashelp&#39;</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">cars</span><span class="o">.</span><span class="n">to_df_DISK</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="n">Make</span>           <span class="nb">object</span>
<span class="n">Model</span>          <span class="nb">object</span>
<span class="n">Type</span>           <span class="nb">object</span>
<span class="n">Origin</span>         <span class="nb">object</span>
<span class="n">DriveTrain</span>     <span class="nb">object</span>
<span class="n">MSRP</span>           <span class="nb">object</span>
<span class="n">Invoice</span>        <span class="nb">object</span>
<span class="n">EngineSize</span>     <span class="nb">object</span>
<span class="n">Cylinders</span>      <span class="nb">object</span>
<span class="n">Horsepower</span>     <span class="nb">object</span>
<span class="n">MPG_City</span>       <span class="nb">object</span>
<span class="n">MPG_Highway</span>    <span class="nb">object</span>
<span class="n">Weight</span>         <span class="nb">object</span>
<span class="n">Wheelbase</span>      <span class="nb">object</span>
<span class="n">Length</span>         <span class="nb">object</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="c1"># Let&#39;s call the new method to get the char column lengths.</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">d1</span> <span class="o">=</span>  <span class="n">sas</span><span class="o">.</span><span class="n">df_char_lengths</span><span class="p">(</span><span class="n">df</span><span class="p">);</span> <span class="n">d1</span>
<span class="p">{</span><span class="s1">&#39;Length&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Invoice&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;Wheelbase&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Model&#39;</span><span class="p">:</span> <span class="mi">39</span><span class="p">,</span> <span class="s1">&#39;Make&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;Cylinders&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
 <span class="s1">&#39;DriveTrain&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;MSRP&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;MPG_City&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Weight&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;MPG_Highway&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="s1">&#39;Origin&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;EngineSize&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Horsepower&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>

<span class="c1"># we can call df2sd on this DF and pass in the char col lengths so we skip that in df2sd</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">sd</span> <span class="o">=</span>  <span class="n">sas</span><span class="o">.</span><span class="n">df2sd</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">char_lengths</span><span class="o">=</span><span class="n">d1</span><span class="p">);</span> <span class="n">sd</span>
<span class="n">Libref</span>  <span class="o">=</span> <span class="n">WORK</span>
<span class="n">Table</span>   <span class="o">=</span> <span class="n">_df</span>
<span class="n">Dsopts</span>  <span class="o">=</span> <span class="p">{}</span>
<span class="n">Results</span> <span class="o">=</span> <span class="n">Pandas</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">sd</span><span class="o">.</span><span class="n">columnInfo</span><span class="p">()</span>
    <span class="n">Member</span>  <span class="n">Num</span>     <span class="n">Variable</span>  <span class="n">Type</span>  <span class="n">Len</span>  <span class="n">Pos</span>
<span class="mi">0</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>    <span class="mi">9</span>    <span class="n">Cylinders</span>  <span class="n">Char</span>    <span class="mi">3</span>   <span class="mi">84</span>
<span class="mi">1</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>    <span class="mi">5</span>   <span class="n">DriveTrain</span>  <span class="n">Char</span>    <span class="mi">5</span>   <span class="mi">64</span>
<span class="mi">2</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>    <span class="mi">8</span>   <span class="n">EngineSize</span>  <span class="n">Char</span>    <span class="mi">3</span>   <span class="mi">81</span>
<span class="mi">3</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>   <span class="mi">10</span>   <span class="n">Horsepower</span>  <span class="n">Char</span>    <span class="mi">3</span>   <span class="mi">87</span>
<span class="mi">4</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>    <span class="mi">7</span>      <span class="n">Invoice</span>  <span class="n">Char</span>    <span class="mi">6</span>   <span class="mi">75</span>
<span class="mi">5</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>   <span class="mi">15</span>       <span class="n">Length</span>  <span class="n">Char</span>    <span class="mi">3</span>  <span class="mi">101</span>
<span class="mi">6</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>   <span class="mi">11</span>     <span class="n">MPG_City</span>  <span class="n">Char</span>    <span class="mi">2</span>   <span class="mi">90</span>
<span class="mi">7</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>   <span class="mi">12</span>  <span class="n">MPG_Highway</span>  <span class="n">Char</span>    <span class="mi">2</span>   <span class="mi">92</span>
<span class="mi">8</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>    <span class="mi">6</span>         <span class="n">MSRP</span>  <span class="n">Char</span>    <span class="mi">6</span>   <span class="mi">69</span>
<span class="mi">9</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>    <span class="mi">1</span>         <span class="n">Make</span>  <span class="n">Char</span>   <span class="mi">13</span>    <span class="mi">0</span>
<span class="mi">10</span>  <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>    <span class="mi">2</span>        <span class="n">Model</span>  <span class="n">Char</span>   <span class="mi">39</span>   <span class="mi">13</span>
<span class="mi">11</span>  <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>    <span class="mi">4</span>       <span class="n">Origin</span>  <span class="n">Char</span>    <span class="mi">6</span>   <span class="mi">58</span>
<span class="mi">12</span>  <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>    <span class="mi">3</span>         <span class="n">Type</span>  <span class="n">Char</span>    <span class="mi">6</span>   <span class="mi">52</span>
<span class="mi">13</span>  <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>   <span class="mi">13</span>       <span class="n">Weight</span>  <span class="n">Char</span>    <span class="mi">4</span>   <span class="mi">94</span>
<span class="mi">14</span>  <span class="n">WORK</span><span class="o">.</span><span class="n">B</span>   <span class="mi">14</span>    <span class="n">Wheelbase</span>  <span class="n">Char</span>    <span class="mi">3</span>   <span class="mi">98</span>
<span class="o">&gt;&gt;&gt;</span>

<span class="c1"># you can just create your own dict with lengths you want, also, and skip the discovery step altogether.</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">d1</span> <span class="o">=</span> <span class="p">{}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<span class="o">...</span>    <span class="n">d1</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>  <span class="o">=</span> <span class="mi">10</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d1</span><span class="p">[</span><span class="s1">&#39;Make&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="mi">15</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d1</span><span class="p">[</span><span class="s1">&#39;Model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">40</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d1</span>
<span class="p">{</span><span class="s1">&#39;MSRP&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Length&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;MPG_City&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Invoice&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Model&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;DriveTrain&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Horsepower&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Make&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;Wheelbase&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;EngineSize&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Origin&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Cylinders&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;MPG_Highway&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Weight&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sd</span> <span class="o">=</span>  <span class="n">sas</span><span class="o">.</span><span class="n">df2sd</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">char_lengths</span><span class="o">=</span><span class="n">d1</span><span class="p">);</span> <span class="n">sd</span>
<span class="n">Libref</span>  <span class="o">=</span> <span class="n">WORK</span>
<span class="n">Table</span>   <span class="o">=</span> <span class="n">_df</span>
<span class="n">Dsopts</span>  <span class="o">=</span> <span class="p">{}</span>
<span class="n">Results</span> <span class="o">=</span> <span class="n">Pandas</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">sd</span><span class="o">.</span><span class="n">columnInfo</span><span class="p">()</span>
      <span class="n">Member</span>  <span class="n">Num</span>     <span class="n">Variable</span>  <span class="n">Type</span>  <span class="n">Len</span>  <span class="n">Pos</span>
<span class="mi">0</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>    <span class="mi">9</span>    <span class="n">Cylinders</span>  <span class="n">Char</span>   <span class="mi">10</span>  <span class="mi">115</span>
<span class="mi">1</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>    <span class="mi">5</span>   <span class="n">DriveTrain</span>  <span class="n">Char</span>   <span class="mi">10</span>   <span class="mi">75</span>
<span class="mi">2</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>    <span class="mi">8</span>   <span class="n">EngineSize</span>  <span class="n">Char</span>   <span class="mi">10</span>  <span class="mi">105</span>
<span class="mi">3</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>   <span class="mi">10</span>   <span class="n">Horsepower</span>  <span class="n">Char</span>   <span class="mi">10</span>  <span class="mi">125</span>
<span class="mi">4</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>    <span class="mi">7</span>      <span class="n">Invoice</span>  <span class="n">Char</span>   <span class="mi">10</span>   <span class="mi">95</span>
<span class="mi">5</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>   <span class="mi">15</span>       <span class="n">Length</span>  <span class="n">Char</span>   <span class="mi">10</span>  <span class="mi">175</span>
<span class="mi">6</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>   <span class="mi">11</span>     <span class="n">MPG_City</span>  <span class="n">Char</span>   <span class="mi">10</span>  <span class="mi">135</span>
<span class="mi">7</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>   <span class="mi">12</span>  <span class="n">MPG_Highway</span>  <span class="n">Char</span>   <span class="mi">10</span>  <span class="mi">145</span>
<span class="mi">8</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>    <span class="mi">6</span>         <span class="n">MSRP</span>  <span class="n">Char</span>   <span class="mi">10</span>   <span class="mi">85</span>
<span class="mi">9</span>   <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>    <span class="mi">1</span>         <span class="n">Make</span>  <span class="n">Char</span>   <span class="mi">15</span>    <span class="mi">0</span>
<span class="mi">10</span>  <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>    <span class="mi">2</span>        <span class="n">Model</span>  <span class="n">Char</span>   <span class="mi">40</span>   <span class="mi">15</span>
<span class="mi">11</span>  <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>    <span class="mi">4</span>       <span class="n">Origin</span>  <span class="n">Char</span>   <span class="mi">10</span>   <span class="mi">65</span>
<span class="mi">12</span>  <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>    <span class="mi">3</span>         <span class="n">Type</span>  <span class="n">Char</span>   <span class="mi">10</span>   <span class="mi">55</span>
<span class="mi">13</span>  <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>   <span class="mi">13</span>       <span class="n">Weight</span>  <span class="n">Char</span>   <span class="mi">10</span>  <span class="mi">155</span>
<span class="mi">14</span>  <span class="n">WORK</span><span class="o">.</span><span class="n">_DF</span>   <span class="mi">14</span>    <span class="n">Wheelbase</span>  <span class="n">Char</span>   <span class="mi">10</span>  <span class="mi">165</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sd</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
    <span class="n">Make</span>           <span class="n">Model</span>   <span class="n">Type</span> <span class="n">Origin</span> <span class="n">DriveTrain</span>   <span class="n">MSRP</span> <span class="n">Invoice</span> <span class="n">EngineSize</span> <span class="n">Cylinders</span> <span class="n">Horsepower</span> <span class="n">MPG_City</span> <span class="n">MPG_Highway</span> <span class="n">Weight</span> <span class="n">Wheelbase</span> <span class="n">Length</span>
<span class="mi">0</span>  <span class="n">Acura</span>             <span class="n">MDX</span>    <span class="n">SUV</span>   <span class="n">Asia</span>        <span class="n">All</span>  <span class="mi">36945</span>   <span class="mi">33337</span>        <span class="mf">3.5</span>         <span class="mi">6</span>        <span class="mi">265</span>       <span class="mi">17</span>          <span class="mi">23</span>   <span class="mi">4451</span>       <span class="mi">106</span>    <span class="mi">189</span>
<span class="mi">1</span>  <span class="n">Acura</span>  <span class="n">RSX</span> <span class="n">Type</span> <span class="n">S</span> <span class="mi">2</span><span class="n">dr</span>  <span class="n">Sedan</span>   <span class="n">Asia</span>      <span class="n">Front</span>  <span class="mi">23820</span>   <span class="mi">21761</span>          <span class="mi">2</span>         <span class="mi">4</span>        <span class="mi">200</span>       <span class="mi">24</span>          <span class="mi">31</span>   <span class="mi">2778</span>       <span class="mi">101</span>    <span class="mi">172</span>
<span class="mi">2</span>  <span class="n">Acura</span>         <span class="n">TSX</span> <span class="mi">4</span><span class="n">dr</span>  <span class="n">Sedan</span>   <span class="n">Asia</span>      <span class="n">Front</span>  <span class="mi">26990</span>   <span class="mi">24647</span>        <span class="mf">2.4</span>         <span class="mi">4</span>        <span class="mi">200</span>       <span class="mi">22</span>          <span class="mi">29</span>   <span class="mi">3230</span>       <span class="mi">105</span>    <span class="mi">183</span>
<span class="mi">3</span>  <span class="n">Acura</span>          <span class="n">TL</span> <span class="mi">4</span><span class="n">dr</span>  <span class="n">Sedan</span>   <span class="n">Asia</span>      <span class="n">Front</span>  <span class="mi">33195</span>   <span class="mi">30299</span>        <span class="mf">3.2</span>         <span class="mi">6</span>        <span class="mi">270</span>       <span class="mi">20</span>          <span class="mi">28</span>   <span class="mi">3575</span>       <span class="mi">108</span>    <span class="mi">186</span>
<span class="mi">4</span>  <span class="n">Acura</span>      <span class="mf">3.5</span> <span class="n">RL</span> <span class="mi">4</span><span class="n">dr</span>  <span class="n">Sedan</span>   <span class="n">Asia</span>      <span class="n">Front</span>  <span class="mi">43755</span>   <span class="mi">39014</span>        <span class="mf">3.5</span>         <span class="mi">6</span>        <span class="mi">225</span>       <span class="mi">18</span>          <span class="mi">24</span>   <span class="mi">3880</span>       <span class="mi">115</span>    <span class="mi">197</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="using-proc-iomoperate-to-find-object-spawner-hosts-and-workspace-server-ports">
<h2>Using Proc iomoperate to find Object Spawner hosts and Workspace Server ports<a class="headerlink" href="#using-proc-iomoperate-to-find-object-spawner-hosts-and-workspace-server-ports" title="Permalink to this headline">¶</a></h2>
<p>If you already use a client to connect to IOM servers, you may have the host and port to OMR
(the SAS Metadata Server), but not necessarily those of the Object Spawners or Workspace Servers.
For Remote IOM connections there are three configuration keys that require some of this other information.
If you can connect to your OMR Server, then you can use the following code to find out the information you need.</p>
<p>The three configuration keys are:</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">iomhost</span> <span class="o">-</span>
    <span class="p">(</span><span class="n">Required</span><span class="p">)</span> <span class="n">The</span> <span class="n">resolvable</span> <span class="n">host</span> <span class="n">name</span><span class="p">,</span> <span class="ow">or</span> <span class="n">IP</span> <span class="n">address</span> <span class="n">to</span> <span class="n">the</span> <span class="n">IOM</span> <span class="nb">object</span> <span class="n">spawner</span><span class="o">.</span>
    <span class="n">New</span> <span class="ow">in</span> <span class="mf">2.1</span><span class="o">.</span><span class="mi">6</span><span class="p">;</span> <span class="n">this</span> <span class="n">can</span> <span class="n">be</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">the</span> <span class="nb">object</span> <span class="n">spawners</span> <span class="n">hosts</span> <span class="k">if</span> <span class="n">you</span> <span class="n">have</span> <span class="n">load</span> <span class="n">balanced</span> <span class="nb">object</span> <span class="n">spawners</span><span class="o">.</span>
    <span class="n">This</span> <span class="n">provides</span> <span class="n">Grid</span> <span class="n">HA</span> <span class="p">(</span><span class="n">High</span> <span class="n">Availability</span><span class="p">)</span>
<span class="n">iomport</span> <span class="o">-</span>
    <span class="p">(</span><span class="n">Required</span><span class="p">)</span> <span class="n">The</span> <span class="n">port</span> <span class="n">that</span> <span class="nb">object</span> <span class="n">spawner</span> <span class="ow">is</span> <span class="n">listening</span> <span class="n">on</span> <span class="k">for</span> <span class="n">workspace</span> <span class="n">server</span> <span class="n">connections</span> <span class="p">(</span><span class="n">workspace</span> <span class="n">server</span> <span class="n">port</span> <span class="o">-</span> <span class="ow">not</span> <span class="nb">object</span> <span class="n">spawner</span> <span class="n">port</span><span class="o">!)</span>.
<span class="n">appserver</span> <span class="o">-</span>
    <span class="n">If</span> <span class="n">you</span> <span class="n">have</span> <span class="n">more</span> <span class="n">than</span> <span class="n">one</span> <span class="n">AppServer</span> <span class="n">defined</span> <span class="n">on</span> <span class="n">OMR</span><span class="p">,</span> <span class="n">then</span> <span class="n">you</span> <span class="n">must</span> <span class="k">pass</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">physical</span> <span class="n">workspace</span> <span class="n">server</span>
    <span class="n">that</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">:</span> <span class="s1">&#39;SASApp - Workspace Server&#39;</span><span class="o">.</span> <span class="n">Without</span> <span class="n">this</span> <span class="n">the</span> <span class="n">Object</span> <span class="n">spawner</span> <span class="n">will</span> <span class="n">only</span> <span class="k">try</span> <span class="n">the</span>
    <span class="n">first</span> <span class="n">one</span> <span class="ow">in</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">app</span> <span class="n">servers</span> <span class="n">it</span> <span class="n">supports</span><span class="o">.</span>
</pre></div>
</div>
<p>First, query to find any available Object Spawners. You would use the &#8216;Machine name :&#8217; value(s) from
this for the &#8216;iomhost&#8217; configuration key. Note that often there will only be one Object Spawner, but
there can be more then one configured.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">proc</span> <span class="n">iomoperate</span>
  <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;iom://omrhost.abc.xyz.com:8561;Bridge;USER=omruserid,PASS=omrpasswd&quot;</span><span class="p">;</span>
  <span class="nb">list</span> <span class="n">DEFINED</span> <span class="n">FILTER</span><span class="o">=</span><span class="s2">&quot;Object&quot;</span><span class="p">;</span>
<span class="n">quit</span><span class="p">;</span>
</pre></div>
</div>
<p>The reuslts from this should include output like the following for any defined Object Spawners.
Use the &#8216;Machine name :&#8217; value for your &#8216;iomhost&#8217; key.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">Object</span> <span class="n">Spawner</span> <span class="o">-</span> <span class="n">objhost</span> <span class="p">(</span><span class="n">A5H4N590</span><span class="o">.</span><span class="n">AY000003</span><span class="p">)</span>
    <span class="n">Server</span> <span class="k">class</span> <span class="err">: </span><span class="nc">IOM</span> <span class="n">Spawner</span>
    <span class="n">Spawnable</span> <span class="n">server</span> <span class="n">component</span> <span class="p">:</span> <span class="n">Operating</span> <span class="n">System</span> <span class="n">Services</span> <span class="o">-</span> <span class="n">objhost</span>
    <span class="n">Spawnable</span> <span class="n">server</span> <span class="n">component</span> <span class="p">:</span> <span class="n">SASApp</span> <span class="o">-</span> <span class="n">Pooled</span> <span class="n">Workspace</span> <span class="n">Server</span>
    <span class="n">Spawnable</span> <span class="n">server</span> <span class="n">component</span> <span class="p">:</span> <span class="n">SASApp</span> <span class="o">-</span> <span class="n">Stored</span> <span class="n">Process</span> <span class="n">Server</span>
    <span class="n">Spawnable</span> <span class="n">server</span> <span class="n">component</span> <span class="p">:</span> <span class="n">SASApp</span> <span class="o">-</span> <span class="n">Workspace</span> <span class="n">Server</span>
    <span class="n">Operator</span> <span class="n">port</span> <span class="p">:</span> <span class="mi">8581</span>
    <span class="n">PortBank</span> <span class="n">port</span> <span class="p">:</span> <span class="mi">8801</span>
    <span class="n">PortBank</span> <span class="n">port</span> <span class="p">:</span> <span class="mi">8811</span>
    <span class="n">PortBank</span> <span class="n">port</span> <span class="p">:</span> <span class="mi">8821</span>
    <span class="n">Machine</span> <span class="n">name</span> <span class="p">:</span> <span class="n">objhost</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">xyz</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>Next, query to find any available Workspace Servers. You would use the &#8216;Bridge port :&#8217; value from
this for the &#8216;iomport&#8217; configuration key. When you have multiple Workspace Servers configured, which
really means you have multipe SASApp&#8217;s defined (see &#8216;Server context :&#8217; value in the output below),
you will want to set the &#8216;appserver&#8217; configuration key to the SASApp Workspace Server that you want
to (or have permission to) connect to. The value to use is the name shown in the output for the server;
&#8216;SASApp - Workspace Server&#8217; in the output below.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">proc</span> <span class="n">iomoperate</span>
  <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;iom://omrhost.abc.xyz.com:8561;Bridge;USER=omruserid,PASS=omrpasswd&quot;</span><span class="p">;</span>
  <span class="nb">list</span> <span class="n">DEFINED</span> <span class="n">FILTER</span><span class="o">=</span><span class="s2">&quot;- Workspace&quot;</span><span class="p">;</span>
<span class="n">quit</span><span class="p">;</span>
</pre></div>
</div>
<p>The reuslts from this should include output like the following for any defined Workspace Servers.
Use the &#8216;Bridge port :&#8217; value for your &#8216;iomport&#8217; key.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">SASApp</span> <span class="o">-</span> <span class="n">Workspace</span> <span class="n">Server</span> <span class="p">(</span><span class="n">A5H4N590</span><span class="o">.</span><span class="n">AY000009</span><span class="p">)</span>
    <span class="n">Server</span> <span class="k">class</span> <span class="err">: 440196</span><span class="nc">D4</span><span class="o">-</span><span class="mi">90</span><span class="n">F0</span><span class="o">-</span><span class="mi">11</span><span class="n">D0</span><span class="o">-</span><span class="mi">9</span><span class="n">F41</span><span class="o">-</span><span class="mo">00</span><span class="n">A024BB830C</span>
    <span class="n">Logical</span> <span class="n">name</span> <span class="p">:</span> <span class="n">SASApp</span> <span class="o">-</span> <span class="n">Logical</span> <span class="n">Workspace</span> <span class="n">Server</span>
    <span class="n">Server</span> <span class="n">context</span> <span class="p">:</span> <span class="n">SASApp</span>
    <span class="n">Bridge</span> <span class="n">port</span> <span class="p">:</span> <span class="mi">8591</span>
    <span class="n">Machine</span> <span class="n">name</span> <span class="p">:</span> <span class="n">wrkhost</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">xyz</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>If your site has a complex setup, you may have multiple Object Spawners and/or Workspace Servers.
If so, it&#8217;s possible that the Workspace Server you want to use is only spawnable for a particular
Object Spawner. You can correlate those by looking for the name of your Workspace Server in the
&#8216;Spawnable server component :&#8217; of the Object Spawner output.</p>
<p>Also, if you have multiple Workspace Server that you want to be able to connect to, you can define
a separate configuration definition (in your sascfg[_personal].py) for each one. A good naming
convention for these is to use the &#8216;Server context :&#8217; value as the config name. That way it&#8217;s easy
to know which server you will be connecting to.</p>
</div>
<div class="section" id="disconnecting-from-an-iom-session-and-reconnecting-back-to-it">
<h2>Disconnecting from an IOM session and reconnecting back to it.<a class="headerlink" href="#disconnecting-from-an-iom-session-and-reconnecting-back-to-it" title="Permalink to this headline">¶</a></h2>
<p>The IOM access method has the ability to disconnect from the workspace server and
reconnect to it (the same one); IF the reconnect setting is configured for that workspace
server in the Metadata Server. See &#8216;Client Reconnect&#8217; Advanced Options of the Workspace Server.
This feature is new in version 2.2.2.</p>
<p>This was implemented for cases like having a laptop in a docking station, connected to LAN (Ethernet).
Then needing to take the laptop to a meeting; network switched to WiFi. Switching the network will lose
the connection to the workspace server.</p>
<p>In order to have this work, before disconnecting from your current network, you submit the disconnect()
method of the SASsession object. You can then change networks. After you have a good network connection again,
the next thing you submit will reconnect to that same workspace server and run.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">sas</span> <span class="o">=</span> <span class="n">saspy</span><span class="o">.</span><span class="n">SASsession</span><span class="p">(</span><span class="n">cfgname</span><span class="o">=</span><span class="s1">&#39;someIOMconfig&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">do</span> <span class="n">some</span> <span class="n">work</span> <span class="k">with</span> <span class="n">saspy</span><span class="p">]</span>
<span class="n">sas</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
<span class="p">[</span><span class="n">switch</span> <span class="n">networks</span><span class="o">.</span> <span class="n">be</span> <span class="n">sure</span> <span class="n">you</span> <span class="n">have</span> <span class="n">established</span> <span class="n">a</span> <span class="n">network</span> <span class="n">connection</span><span class="p">]</span>
<span class="n">do</span> <span class="n">more</span> <span class="n">saspy</span> <span class="n">work</span>
</pre></div>
</div>
<p>New as of Version 3.6.7, based upon a customer request, after disconnecting, a reconnection URI is
stored off of the SASsesion object, in an attribute named &#8216;reconuri&#8217;. This is the token that is automatically
used to reconnect when your next saspy method is invoked. But, now you can terminate your python process, after
getting this reconuti value, and use it to reconnect from a new Python process by specifying it in the SASsession()
method: sas = saspy.SASsession(reconuri=&#8217;&#8216;). This isn&#8217;t a usual use case, and this can only be used to connect from
a single process, and each time a disconnect happens a new toke is created. But, a user wanted this feature for a
specific case, so it is now available.</p>
</div>
<div class="section" id="configuring-grid-option-sets-to-have-saspy-run-on-a-specific-queue">
<h2>Configuring Grid Option Sets to have saspy run on a specific Queue.<a class="headerlink" href="#configuring-grid-option-sets-to-have-saspy-run-on-a-specific-queue" title="Permalink to this headline">¶</a></h2>
<p>Working with Grid Options Sets is documented here (the &#8216;Doc&#8217; referred to below):
<a class="reference external" href="http://support.sas.com/documentation/cdl/en/gridref/67371/HTML/default/viewer.htm#n1inymfs0b7go2n147xdknz0ygpx.htm">http://support.sas.com/documentation/cdl/en/gridref/67371/HTML/default/viewer.htm#n1inymfs0b7go2n147xdknz0ygpx.htm</a></p>
<p>There is also a SASPy issue with details on this here:
<a class="reference external" href="https://github.com/sassoftware/saspy/issues/82">https://github.com/sassoftware/saspy/issues/82</a></p>
<p>This is specific to the IOM Access Method, as that is how saspy connects to the SAS Grid with this functionality.
The Appname that saspy connects as is &#8216;SASPy&#8217;; as in APPNAME=SASPy</p>
<p>There are 2 steps to setting this up. The first is to define the SASPy Application in metadata and set it as Grid Capable.
That part in the doc (link referenced above) is at the bottom, named &#8216;Specifying That an Application Is Grid Capable&#8217;.</p>
<p>The second is to select and configure that SASPy App in the Grid Options Set Mapping Wizard; the first part of the doc.</p>
<p>1) in the &#8216;Folders&#8217; view in SMC (like in the picture in the doc link), there&#8217;s a list of applications. The doc has the SAS Addin for Microsoft Office selected.
If you right click on Applications, you can selct &#8216;New&#8217;-&gt;&#8217;Folder.</p>
<p>2) Do that and set the name of the new folder to SASPy. Then right click and select Properties - just like in the picture in the doc.
Then add a Keyword-&gt; &#8216;isGridCapable&#8217; and save it. Just like the picture in the doc.</p>
<p>After creating the SASPy folder (application), and setting it to grid capable, when you go back
in to the grid options mapping wizard (the first part of the document referenced above), SASPy
should now be available to choose and you can set this up as you want.</p>
</div>
<div class="section" id="dates-times-and-datetimes-oh-my">
<h2>Dates, Times and Datetimes, Oh my!<a class="headerlink" href="#dates-times-and-datetimes-oh-my" title="Permalink to this headline">¶</a></h2>
<p>The sd2df and df2sd methods transfer data between SAS Data Sets and Pandas dataframes. For most
cases, if you start with a SAS dataset and import it to a dataframe, then send it back to SAS,
you should end up with the same data in SAS as you started with. However, there are some caveats.
First, SAS Formats do not transfer to a dataframe, so on the round trip the new SAS dataset will
not necessarily have the same formats defined on it as the original data set. Starting in saspy
version3.2.0, there is an option on df2sd to specify the formats you want defined on the new data
set; outfmts={}. The keys for this are the column names and the values are the SAS formats you
want defined.</p>
<p>For example:
df2sd(..., outfmts={&#8216;col1&#8217; : &#8216;YYMMDD.&#8217;, &#8216;col2&#8217; : &#8216;TIMEAMPM.&#8217;, &#8216;some_numeric_col&#8217; : &#8216;comma32.4&#8217;})</p>
<p>To see the formats that are defined on the original data set, use the contents() or columnInfo()
method on that SASdata object.</p>
<p>One other issue is with SAS variables having Date and Time formats, which are logically data types
of Date or Time. SAS only really has Numeric and Character data types, but the date, time, and
datetime formats on Numeric variables identify them as representing date, time, or datetime data
types. Pandas dataframe, has a datetime datatype, but not a date or a time datatype. When using
sd2df, any SAS variable with date, time or datetime formats will be created in the dataframe as a
datetime64[ns]. It is easy enough in python to reference only the date part, or time part of a
pandas datetime column. In fact the column can be converted to datetime.date or datetime.time
with one python statement. For instance, given datetime columns, the following can convert to
the datetime date or time:</p>
<p>Given df_conv.dtypes:</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">dt</span>     <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span>
<span class="n">tm</span>     <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span>


<span class="n">convert</span> <span class="n">datetime</span> <span class="n">columns</span> <span class="n">to</span> <span class="n">date</span> <span class="ow">or</span> <span class="n">time</span> <span class="n">only</span> <span class="nb">type</span> <span class="p">(</span><span class="n">honoring</span> <span class="n">missing</span> <span class="n">values</span><span class="p">)</span>

<span class="n">nat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">df_conv</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_conv</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">nat</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">df_conv</span><span class="p">[</span><span class="s1">&#39;tm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_conv</span><span class="p">[</span><span class="s1">&#39;tm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">nat</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">time</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>


<span class="n">convert</span> <span class="n">these</span> <span class="n">back</span> <span class="n">to</span> <span class="n">datetimes</span>

<span class="n">df_conv</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_conv</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">),</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">df_conv</span><span class="p">[</span><span class="s1">&#39;tm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_conv</span><span class="p">[</span><span class="s1">&#39;tm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">),</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>When using df2sd to transfer a dataframe to a SAS data set, with values you want to be stored as SAS
dates, times or datetimes, the following is the appropriate way to do so. In each case, the value
in the dataframe must be a Pandas datetime64 value. For datetimes this just works. For date or
time only values, specify the (new in V3.2.0) option datetimes={} on df2sd. The datetimes={} takes
keys of the column names and values of &#8216;date&#8217; or &#8216;time&#8217;. The code generated to create the SAS data
set will then only use the date or time portion of the Pandas datetime64 value to populate the SAS
variables, and assign default date or time formats for those variables. You can, of course, specify
specific date or time formats using the outfmts={} option if you want.</p>
<p>For example:
df2sd(..., datetimes={&#8216;d&#8217; : &#8216;date&#8217;, &#8216;t&#8217; : &#8216;time&#8217;})</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1965</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1965</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1965</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span>
               <span class="n">dt</span>                   <span class="n">d</span>                   <span class="n">t</span>
<span class="mi">0</span> <span class="mi">1965</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">01</span> <span class="mi">08</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span> <span class="mi">1965</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">01</span> <span class="mi">08</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span> <span class="mi">1965</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">01</span> <span class="mi">08</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">sd</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">df2sd</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">datetimes</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;d&#39;</span> <span class="p">:</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span> <span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">},</span> <span class="n">results</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sd</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>


                                                           <span class="n">The</span> <span class="n">SAS</span> <span class="n">System</span>                         <span class="mi">11</span><span class="p">:</span><span class="mi">31</span> <span class="n">Friday</span><span class="p">,</span> <span class="n">January</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">2020</span>   <span class="mi">2</span>

                                    <span class="n">Obs</span>    <span class="n">dt</span>                                <span class="n">d</span>            <span class="n">t</span>

                                     <span class="mi">1</span>     <span class="mi">1965</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">01</span><span class="n">T08</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mf">01.000000</span>    <span class="mi">1965</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">01</span>    <span class="mi">08</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># For &#39;dt&#39; column, we still import it as a datetime, but specifying a numeric format will display it as a number (seconds since Jan 1,  1960)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># and I&#39;ve chosen different date and time formats for the other two variables too</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sd</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">df2sd</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">datetimes</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;d&#39;</span> <span class="p">:</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span> <span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">},</span> <span class="n">outfmts</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dt&#39;</span> <span class="p">:</span> <span class="s1">&#39;comma32.4&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span> <span class="p">:</span> <span class="s1">&#39;YYMMDD.&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span> <span class="p">:</span> <span class="s1">&#39;TIMEAMPM.&#39;</span><span class="p">},</span> <span class="n">results</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sd</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
                                                           <span class="n">The</span> <span class="n">SAS</span> <span class="n">System</span>                         <span class="mi">09</span><span class="p">:</span><span class="mi">59</span> <span class="n">Friday</span><span class="p">,</span> <span class="n">January</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">2020</span>   <span class="mi">1</span>

                                 <span class="n">Obs</span>                                  <span class="n">dt</span>           <span class="n">d</span>             <span class="n">t</span>

                                  <span class="mi">1</span>                     <span class="mi">157</span><span class="p">,</span><span class="mi">881</span><span class="p">,</span><span class="mf">601.0000</span>    <span class="mi">65</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mo">01</span>    <span class="mi">8</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span> <span class="n">AM</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>For more examples of this date, time, datetime conversion, see the example notebook here:
<a class="reference external" href="https://github.com/sassoftware/saspy-examples/blob/master/Issue_examples/Issue279.ipynb">https://github.com/sassoftware/saspy-examples/blob/master/Issue_examples/Issue279.ipynb</a></p>
</div>
<div class="section" id="advanced-sd2df-and-df2sd-techniques">
<h2>Advanced sd2df and df2sd techniques<a class="headerlink" href="#advanced-sd2df-and-df2sd-techniques" title="Permalink to this headline">¶</a></h2>
<p>The sd2df and df2sd methods transfer data between SAS Data Sets and Pandas dataframes. For most cases,
you don&#8217;t need to specify extra options. But, there are extra options to cover a variety of specific
use cases. The section above describes using the datetime= and outfmts= with df2sd, and this section will
show how to manipulate sd2df if you want your dataframe to have non-default dtypes. Based upon an issue
request to allow the dataframe created by sd2df to have differnent types than what are created by default,
there are a couple options which can be used to accomplish this.</p>
<p>Both the CSV and DISK methods of sd2df use Pandas read_csv method to create the dataframe from a file
containing the SAS data. The read_csv method has many options. By default the sd2df CSV and DISK methods
supply some of these parameters to control how the dataframe is created. There are two things in particular
that must correlate to get the correct results in the dataframe. They are the format of the data values,
for a given column, and the dtype specified for the creation of the column. The format of the data is
controlled by the SAS format being used to write the data values. The dtype is controlled by the dtype=
parameter on read_csv. By default saspy controls both of these, matching them up to create the valid
dataframe columns.</p>
<p>The sd2df* methods take a kwargs parameter. This can be used to pass through pandas parameters to the
create dataframe method. dtype= is one of these that you can pass through. If you pass this through,
then sd2df will not set the dtypes itself for any column. It will pass your dtype= value to read_csv. Now,
if the format of the data values doesn&#8217;t match what Pandas can parse into the dtypes you specify, then
it won&#8217;t work correctly. But, as of saspy version 3.2.0, there is an option (my_fmts=) to override
saspy&#8217;s choice of formats for writing the data values and use the formats defined on the data set, or
specified by you via the dsopts= parameter (or attribute of a SASdata object); my_fmts = [<strong>False</strong> | True].
In this way, you can control both the format of the data values and the dtypes you want Pandas to create
from them.</p>
<p>Let&#8217;s loot at an example. One request was to have all of the data in the dataframe be string types.
This can be done quite easily with just the dtype= parameter.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># lets get two numerics from the cars dataset. FYI, they have formats defined as DOLLAR8.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">sd2df_DISK</span><span class="p">(</span><span class="s1">&#39;cars&#39;</span><span class="p">,</span> <span class="s1">&#39;sashelp&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">,</span>      <span class="n">dsopts</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;keep&#39;</span> <span class="p">:</span> <span class="s1">&#39;MSRP Invoice&#39;</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="n">MSRP</span>       <span class="nb">object</span>
<span class="n">Invoice</span>    <span class="nb">object</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
    <span class="n">MSRP</span> <span class="n">Invoice</span>
<span class="mi">0</span>  <span class="mi">36945</span>   <span class="mi">33337</span>
<span class="mi">1</span>  <span class="mi">23820</span>   <span class="mi">21761</span>
<span class="mi">2</span>  <span class="mi">26990</span>   <span class="mi">24647</span>
<span class="mi">3</span>  <span class="mi">33195</span>   <span class="mi">30299</span>
<span class="mi">4</span>  <span class="mi">43755</span>   <span class="mi">39014</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Now, since we&#8217;re creating these as stings, we probably want the SAS formatted version of the strings;
same as we would see in the SAS output of the data. So, we set my_fmts=True.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">sd2df_DISK</span><span class="p">(</span><span class="s1">&#39;cars&#39;</span><span class="p">,</span> <span class="s1">&#39;sashelp&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">my_fmts</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>     <span class="n">dsopts</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;keep&#39;</span> <span class="p">:</span> <span class="s1">&#39;MSRP Invoice&#39;</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="n">MSRP</span>       <span class="nb">object</span>
<span class="n">Invoice</span>    <span class="nb">object</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
      <span class="n">MSRP</span>  <span class="n">Invoice</span>
<span class="mi">0</span>  <span class="err">$</span><span class="mi">36</span><span class="p">,</span><span class="mi">945</span>  <span class="err">$</span><span class="mi">33</span><span class="p">,</span><span class="mi">337</span>
<span class="mi">1</span>  <span class="err">$</span><span class="mi">23</span><span class="p">,</span><span class="mi">820</span>  <span class="err">$</span><span class="mi">21</span><span class="p">,</span><span class="mi">761</span>
<span class="mi">2</span>  <span class="err">$</span><span class="mi">26</span><span class="p">,</span><span class="mi">990</span>  <span class="err">$</span><span class="mi">24</span><span class="p">,</span><span class="mi">647</span>
<span class="mi">3</span>  <span class="err">$</span><span class="mi">33</span><span class="p">,</span><span class="mi">195</span>  <span class="err">$</span><span class="mi">30</span><span class="p">,</span><span class="mi">299</span>
<span class="mi">4</span>  <span class="err">$</span><span class="mi">43</span><span class="p">,</span><span class="mi">755</span>  <span class="err">$</span><span class="mi">39</span><span class="p">,</span><span class="mo">014</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>And, if you wanted to specify your own SAS format to use for this, overriding the ones defined on
the dataset, you can specify it on the dsopts=.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">sd2df_DISK</span><span class="p">(</span><span class="s1">&#39;cars&#39;</span><span class="p">,</span> <span class="s1">&#39;sashelp&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">my_fmts</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                     <span class="n">dsopts</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;keep&#39;</span> <span class="p">:</span> <span class="s1">&#39;MSRP Invoice&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;msrp&#39;</span><span class="p">:</span><span class="s1">&#39;dollar32.2&#39;</span><span class="p">}})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="n">MSRP</span>       <span class="nb">object</span>
<span class="n">Invoice</span>    <span class="nb">object</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
         <span class="n">MSRP</span>  <span class="n">Invoice</span>
<span class="mi">0</span>  <span class="err">$</span><span class="mi">36</span><span class="p">,</span><span class="mf">945.00</span>  <span class="err">$</span><span class="mi">33</span><span class="p">,</span><span class="mi">337</span>
<span class="mi">1</span>  <span class="err">$</span><span class="mi">23</span><span class="p">,</span><span class="mf">820.00</span>  <span class="err">$</span><span class="mi">21</span><span class="p">,</span><span class="mi">761</span>
<span class="mi">2</span>  <span class="err">$</span><span class="mi">26</span><span class="p">,</span><span class="mf">990.00</span>  <span class="err">$</span><span class="mi">24</span><span class="p">,</span><span class="mi">647</span>
<span class="mi">3</span>  <span class="err">$</span><span class="mi">33</span><span class="p">,</span><span class="mf">195.00</span>  <span class="err">$</span><span class="mi">30</span><span class="p">,</span><span class="mi">299</span>
<span class="mi">4</span>  <span class="err">$</span><span class="mi">43</span><span class="p">,</span><span class="mf">755.00</span>  <span class="err">$</span><span class="mi">39</span><span class="p">,</span><span class="mo">014</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>The dtype= parameter can also be a dictionary for each column and type. See the Pandas doc for more
on that. So, you can control the format and type of each column yourself, but it is then up to you
to be sure the values can be parsed by Pandas to the types you specify. When using these options,
sd2df will not override anything you&#8217;ve provided, so you control it all.</p>
<p>One last example where You only want to override one column and have the other defaulted.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">sd2df_DISK</span><span class="p">(</span><span class="s1">&#39;cars&#39;</span><span class="p">,</span> <span class="s1">&#39;sashelp&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;invoice&#39;</span> <span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">},</span> <span class="n">my_fmts</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                     <span class="n">dsopts</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;keep&#39;</span> <span class="p">:</span> <span class="s1">&#39;MSRP Invoice&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;msrp&#39;</span><span class="p">:</span><span class="s1">&#39;dollar32.2&#39;</span><span class="p">,</span><span class="s1">&#39;invoice&#39;</span><span class="p">:</span><span class="s1">&#39;best32.&#39;</span><span class="p">}})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="n">MSRP</span>       <span class="nb">object</span>
<span class="n">Invoice</span>     <span class="n">int64</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
         <span class="n">MSRP</span>  <span class="n">Invoice</span>
<span class="mi">0</span>  <span class="err">$</span><span class="mi">36</span><span class="p">,</span><span class="mf">945.00</span>    <span class="mi">33337</span>
<span class="mi">1</span>  <span class="err">$</span><span class="mi">23</span><span class="p">,</span><span class="mf">820.00</span>    <span class="mi">21761</span>
<span class="mi">2</span>  <span class="err">$</span><span class="mi">26</span><span class="p">,</span><span class="mf">990.00</span>    <span class="mi">24647</span>
<span class="mi">3</span>  <span class="err">$</span><span class="mi">33</span><span class="p">,</span><span class="mf">195.00</span>    <span class="mi">30299</span>
<span class="mi">4</span>  <span class="err">$</span><span class="mi">43</span><span class="p">,</span><span class="mf">755.00</span>    <span class="mi">39014</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Remember, if you want to send data like this back to a SAS data set and you want the original types,
you need to have any numerics as a numeric type, dates, times or datetimes as a datetime64 type. You can
use the datetimes= to create date or time SAS variables from a full datetime, and anything that is
an Object type, will be a character variable in SAS, with the str() of the object as the value.</p>
<p>There&#8217;s more interesting reading about this on the issue that started it. Take a look at
<a class="reference external" href="https://github.com/sassoftware/saspy/issues/279">https://github.com/sassoftware/saspy/issues/279</a> to see where this fuctionality came from.</p>
</div>
<div class="section" id="automatic-checking-for-error-in-the-log-and-the-warnings-module">
<h2>Automatic checking for ERROR: in the LOG and the warnings module<a class="headerlink" href="#automatic-checking-for-error-in-the-log-and-the-warnings-module" title="Permalink to this headline">¶</a></h2>
<p>Based upon an enhancement request, as of version 3.6.7, SASPy now checks for &#8216;ERROR:&#8217; and issues a message via the warnings module
to inform you that you should take a look at the log and see if there was a problem. SASPy methods won&#8217;t blindly fail just by finding
the word ERROR in the log, because that doesn&#8217;t always mean what was being done failed. Nor does not having that in the log mean everything
worked perfectly. SAS isn&#8217;t that straight forward, unfortunately. Most methods verify what happened, when they can, but particularly on the
data transfer methods, there are any number of things that can happen, so querying the log after these, especially when first developing
workflows, is always a good thing. You can use the lastlog() method to see the log for the last method run or saslog() to see the entire
session log.</p>
<p>There is also a new attribute on the SASsession object (my SASsession variable is &#8216;sas&#8217; in the examples). This variable is a boolean
set to True when one of these warnings is issued (regardless of how you&#8217;ve configured warnings; I set it every time). The name is &#8216;check_error_log&#8217;.
You can use this to programmatically check to see if there was an ERROR in the log. One catch is that it&#8217;s up to you to reset the attribute
to False (it is Fales when the session is created). So, if you are going to check it after running a SASPy method, you should set it to False
before running that method. I can&#8217;t reset it since many methods submit multiple sets of SAS code, and I need to leave it set so it&#8217;s set when
all the code for a given method has completed. There&#8217;s no good place where I can explicitly reset it. It&#8217;s easy enough to set and check though,
when you need to use it.</p>
<p>Here are some examples of the warnings messages and some ways to configure them. For a full explanation of what you can do with
warnings, refer to the Python documentation. Warnings is part of the Python Standard Library. BTW, to supress these, so it&#8217;s as it was
before adding this enhancement, you can simply import warnings and then submit warnings.filterwarnings(&#8220;ignore&#8221;,module=&#8217;saspy&#8217;). Remember
also that since sascfg_personal is an imported module, you can add the import and filterwarnings statement to it if you want to default this and
then you won&#8217;t need it in your individual programs, though you can then still change the filerwarnings setting in any program by just
submitting it in the program, which will override what was in the config file.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="c1"># I had a table which was giving an ERROR in the log, though any error from any method would do the same</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">saslib</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">check_error_log</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">list_tables</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">tom</span><span class="o">/</span><span class="n">github</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">sasioiom</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">976</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Noticed</span> <span class="s1">&#39;ERROR:&#39;</span> <span class="ow">in</span> <span class="n">LOG</span><span class="p">,</span> <span class="n">you</span> <span class="n">ought</span> <span class="n">to</span> <span class="n">take</span> <span class="n">a</span> <span class="n">look</span> <span class="ow">and</span> <span class="n">see</span> <span class="k">if</span> <span class="n">there</span> <span class="n">was</span> <span class="n">a</span> <span class="n">problem</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Noticed &#39;ERROR:&#39; in LOG, you ought to take a look and see if there was a problem&quot;</span><span class="p">)</span>
<span class="p">[(</span><span class="s1">&#39;3 BAD NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;AF&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CARSFR&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CHARF&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;PRDSALE&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># we can check the attribut to programmatically see there was an error and do whatever we want to do in the program with that info</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">check_error_log</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># and we should reset it to False before checking it again; usually right before a method we check it after.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">check_error_log</span> <span class="o">=</span> <span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># so, look at the log to see why there was an error - I&#39;m only showing the line with the error to save space here</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">sas</span><span class="o">.</span><span class="n">lastlog</span><span class="p">())</span>

<span class="p">[</span><span class="o">...</span><span class="p">]</span>
<span class="n">ERROR</span><span class="p">:</span> <span class="n">Some</span> <span class="n">character</span> <span class="n">data</span> <span class="n">was</span> <span class="n">lost</span> <span class="n">during</span> <span class="n">transcoding</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">dataset</span> <span class="n">X</span><span class="o">.</span><span class="n">PRDSALE</span><span class="o">.</span> <span class="n">Either</span> <span class="n">the</span> <span class="n">data</span> <span class="n">contains</span> <span class="n">characters</span> <span class="n">that</span> <span class="n">are</span> <span class="ow">not</span>
       <span class="n">representable</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">new</span> <span class="n">encoding</span> <span class="ow">or</span> <span class="n">truncation</span> <span class="n">occurred</span> <span class="n">during</span> <span class="n">transcoding</span><span class="o">.</span>
<span class="p">[</span><span class="o">...</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Interesting, but that wasn&#39;t an error that kept my program from working</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># with warnings, the default I observe is that a specific warning only gets issued once; this same error is in the log each time</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">list_tables</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="p">[(</span><span class="s1">&#39;3 BAD NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;AF&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CARSFR&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CHARF&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;PRDSALE&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">list_tables</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="p">[(</span><span class="s1">&#39;3 BAD NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;AF&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CARSFR&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CHARF&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;PRDSALE&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># and again, even though warnings didn&#39;t display a message, sas.check_error_log is set because there still was an ERROR in the log</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">check_error_log</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># You can change the behavior to have the warning issued every time, or some number of times, or even make it throw an exception</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">warnings</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;always&quot;</span><span class="p">,</span><span class="n">module</span><span class="o">=</span><span class="s1">&#39;saspy&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">list_tables</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">tom</span><span class="o">/</span><span class="n">github</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">sasioiom</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">976</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Noticed</span> <span class="s1">&#39;ERROR:&#39;</span> <span class="ow">in</span> <span class="n">LOG</span><span class="p">,</span> <span class="n">you</span> <span class="n">ought</span> <span class="n">to</span> <span class="n">take</span> <span class="n">a</span> <span class="n">look</span> <span class="ow">and</span> <span class="n">see</span> <span class="k">if</span> <span class="n">there</span> <span class="n">was</span> <span class="n">a</span> <span class="n">problem</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Noticed &#39;ERROR:&#39; in LOG, you ought to take a look and see if there was a problem&quot;</span><span class="p">)</span>
<span class="p">[(</span><span class="s1">&#39;3 BAD NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;AF&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CARSFR&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CHARF&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;PRDSALE&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">list_tables</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">tom</span><span class="o">/</span><span class="n">github</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">sasioiom</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">976</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Noticed</span> <span class="s1">&#39;ERROR:&#39;</span> <span class="ow">in</span> <span class="n">LOG</span><span class="p">,</span> <span class="n">you</span> <span class="n">ought</span> <span class="n">to</span> <span class="n">take</span> <span class="n">a</span> <span class="n">look</span> <span class="ow">and</span> <span class="n">see</span> <span class="k">if</span> <span class="n">there</span> <span class="n">was</span> <span class="n">a</span> <span class="n">problem</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Noticed &#39;ERROR:&#39; in LOG, you ought to take a look and see if there was a problem&quot;</span><span class="p">)</span>
<span class="p">[(</span><span class="s1">&#39;3 BAD NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;AF&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CARSFR&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CHARF&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;PRDSALE&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">list_tables</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">tom</span><span class="o">/</span><span class="n">github</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">sasioiom</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">976</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Noticed</span> <span class="s1">&#39;ERROR:&#39;</span> <span class="ow">in</span> <span class="n">LOG</span><span class="p">,</span> <span class="n">you</span> <span class="n">ought</span> <span class="n">to</span> <span class="n">take</span> <span class="n">a</span> <span class="n">look</span> <span class="ow">and</span> <span class="n">see</span> <span class="k">if</span> <span class="n">there</span> <span class="n">was</span> <span class="n">a</span> <span class="n">problem</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Noticed &#39;ERROR:&#39; in LOG, you ought to take a look and see if there was a problem&quot;</span><span class="p">)</span>
<span class="p">[(</span><span class="s1">&#39;3 BAD NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;AF&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CARSFR&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CHARF&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;PRDSALE&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span><span class="n">module</span><span class="o">=</span><span class="s1">&#39;saspy&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">list_tables</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
  <span class="n">File</span> <span class="s2">&quot;/opt/tom/github/saspy/saspy/sasbase.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2064</span><span class="p">,</span> <span class="ow">in</span> <span class="n">list_tables</span>
    <span class="n">ll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;/opt/tom/github/saspy/saspy/sasioiom.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">976</span><span class="p">,</span> <span class="ow">in</span> <span class="n">submit</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Noticed &#39;ERROR:&#39; in LOG, you ought to take a look and see if there was a problem&quot;</span><span class="p">)</span>
<span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Noticed</span> <span class="s1">&#39;ERROR:&#39;</span> <span class="ow">in</span> <span class="n">LOG</span><span class="p">,</span> <span class="n">you</span> <span class="n">ought</span> <span class="n">to</span> <span class="n">take</span> <span class="n">a</span> <span class="n">look</span> <span class="ow">and</span> <span class="n">see</span> <span class="k">if</span> <span class="n">there</span> <span class="n">was</span> <span class="n">a</span> <span class="n">problem</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">list_tables</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
  <span class="n">File</span> <span class="s2">&quot;/opt/tom/github/saspy/saspy/sasbase.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2064</span><span class="p">,</span> <span class="ow">in</span> <span class="n">list_tables</span>
    <span class="n">ll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;/opt/tom/github/saspy/saspy/sasioiom.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">976</span><span class="p">,</span> <span class="ow">in</span> <span class="n">submit</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Noticed &#39;ERROR:&#39; in LOG, you ought to take a look and see if there was a problem&quot;</span><span class="p">)</span>
<span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Noticed</span> <span class="s1">&#39;ERROR:&#39;</span> <span class="ow">in</span> <span class="n">LOG</span><span class="p">,</span> <span class="n">you</span> <span class="n">ought</span> <span class="n">to</span> <span class="n">take</span> <span class="n">a</span> <span class="n">look</span> <span class="ow">and</span> <span class="n">see</span> <span class="k">if</span> <span class="n">there</span> <span class="n">was</span> <span class="n">a</span> <span class="n">problem</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">warnings</span><span class="o">.</span><span class="n">resetwarnings</span><span class="p">()</span>
</pre></div>
</div>
<p>Hopefully you will find this enhancement useful. It would be great if each thing done in SAS returned a clean return code to check, but that&#8217;s
not the case. So, checking the log is something that&#8217;s necessary sometimes. Hopefully this warning when an ERROR is seen, will make this easier.</p>
</div>
<div class="section" id="saspy-logger-from-logging-logger-as-of-v3-7-5">
<h2>saspy.logger from logging.logger as of V3.7.5<a class="headerlink" href="#saspy-logger-from-logging-logger-as-of-v3-7-5" title="Permalink to this headline">¶</a></h2>
<p>Per a user request to get rid of using print() for variaous messages, and use the logging facility instead, I&#8217;ve
replaced all non-interactive prints() in saspy (print is still used for prompting, as it needs to be) with
logger calls. The different messages now fall into logging categories (DEBUG, INFO, WARNING, ERROR, FATAL)
so that you can control the level of messages you get.</p>
<p>You can also reconfigure the logger to your wishes, so you can have it written to a file instead of, or as
well as, STDOUT. You can change any of the defaults, including resetting them to the actual Python defaults;
I have some of the saspy.logger defaults changed for backward compatibility. This way you still get the messages
you always have (the Python default level is WARNING, so you would no longer get many you previously have with
that setting). Below I&#8217;ll show some examples of changing this, but you can always look at the Python logging
module doc to see what all of your options are: <a class="reference external" href="https://docs.python.org/3.9/library/logging.html#module-logging">https://docs.python.org/3.9/library/logging.html#module-logging</a></p>
<p>First, let&#8217;s look at the changes I made to the Python defaults, for saspy backward compatibility. After, I&#8217;ll
show how to reset them to the Python defaults if that&#8217;s what you want.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">))</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">propagate</span><span class="o">=</span><span class="bp">False</span>
</pre></div>
</div>
<p>First, the logger is associated with the saspy module, so you access it as saspy.logger, after you import saspy.</p>
<p>The first change is to route messages to STDOUT instead of STDERR (the Python default). This was because for
Jupyter notebooks, ALL message levels (from debug to error) when sent to STDERR, are displayed in RED reverse
video (highlighted in RED). This mean that every message is now in RED, which would be a glaring change in every
notebook using saspy. Written to STDOUT, they show up same as before. And in non-notebook cases, the messages
still show up where they did before (because print() goes to stdout too).</p>
<p>The next change is to set the level to INFO instead of WARNING. Many of the messages saspy writes out under normal
conditions are INFO level messages. So, to get the same messages you have previously gotten, setting level to INFO
keeps backward compatibility for you programs. You can set this to whatever you like, though, of course.</p>
<p>Setting propogate to False keeps every message from being duplicated with the name of the logger prepended. Again,
so your output looks the same as before.</p>
<p>Now, if you want to configure the logger your way, you can add your configuration to your sascfg_personal.py file,
as it is imported after the logger is set up, and before any logging would happen. So doing it this way will have
your configuration in effect every time you use saspy.</p>
<p>Here&#8217;s an example showing how you can change these back to the python defaults (again, add this in the config file).</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">saspy</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">handlers</span>  <span class="o">=</span> <span class="p">[]</span>
<span class="n">saspy</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">level</span>     <span class="o">=</span> <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
<span class="n">saspy</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">propagate</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>There are a lot of ways you can configure logging, from adding handlers and formaters. To add a handler to write
messages to a log file, you can just do this:</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">saspy</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s1">&#39;./saspylogger.log&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>If you want RED reverse video on all messages in a notebook, you can set the default handler I configured back to
it&#8217;s default (STDERR) and then all messages in the notebook will be RED, like any other application using logging.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">saspy</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
</pre></div>
</div>
<p>Here&#8217;s just a little example of a programm showing some of this.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">tom64</span><span class="o">-</span><span class="mi">5</span><span class="o">&gt;</span> <span class="n">python3</span><span class="o">.</span><span class="mi">5</span>
<span class="n">Python</span> <span class="mf">3.5</span><span class="o">.</span><span class="mi">6</span> <span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="n">Nov</span> <span class="mi">16</span> <span class="mi">2018</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">39</span><span class="p">)</span>
<span class="p">[</span><span class="n">GCC</span> <span class="mf">4.4</span><span class="o">.</span><span class="mi">7</span> <span class="mi">20120313</span> <span class="p">(</span><span class="n">Red</span> <span class="n">Hat</span> <span class="mf">4.4</span><span class="o">.</span><span class="mi">7</span><span class="o">-</span><span class="mi">23</span><span class="p">)]</span> <span class="n">on</span> <span class="n">linux</span>
<span class="n">Type</span> <span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="s2">&quot;copyright&quot;</span><span class="p">,</span> <span class="s2">&quot;credits&quot;</span> <span class="ow">or</span> <span class="s2">&quot;license&quot;</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">saspy</span><span class="o">,</span> <span class="nn">logging</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">saspy</span><span class="o">.</span><span class="n">logger</span>
<span class="o">&lt;</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f01e9058ac8</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">prev</span> <span class="o">=</span> <span class="n">saspy</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">level</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">saspy</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span> <span class="c1"># ERROR)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">saspy</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">level</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">prev</span><span class="p">,</span><span class="n">cur</span>
<span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">saspy</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">handlers</span>
<span class="p">[</span><span class="o">&lt;</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f01e92bc6a0</span><span class="o">&gt;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">saspy</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s1">&#39;./saspylogger.log&#39;</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">saspy</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">handlers</span>
<span class="p">[</span><span class="o">&lt;</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f01e92bc6a0</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f01e92bc3c8</span><span class="o">&gt;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span> <span class="o">=</span> <span class="n">saspy</span><span class="o">.</span><span class="n">SASsession</span><span class="p">(</span><span class="n">cfgname</span><span class="o">=</span><span class="s1">&#39;sdssas&#39;</span><span class="p">)</span>
<span class="n">SAS</span> <span class="n">Connection</span> <span class="n">established</span><span class="o">.</span> <span class="n">Subprocess</span> <span class="nb">id</span> <span class="ow">is</span> <span class="mi">21595</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span>
<span class="n">Access</span> <span class="n">Method</span>         <span class="o">=</span> <span class="n">STDIO</span>
<span class="n">SAS</span> <span class="n">Config</span> <span class="n">name</span>       <span class="o">=</span> <span class="n">sdssas</span>
<span class="n">SAS</span> <span class="n">Config</span> <span class="nb">file</span>       <span class="o">=</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">tom</span><span class="o">/</span><span class="n">github</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">sascfg_personal</span><span class="o">.</span><span class="n">py</span>
<span class="n">WORK</span> <span class="n">Path</span>             <span class="o">=</span> <span class="o">/</span><span class="n">sastmp</span><span class="o">/</span><span class="n">SAS_work95EA00005477_tom64</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span>
<span class="n">SAS</span> <span class="n">Version</span>           <span class="o">=</span> <span class="mf">9.04</span><span class="o">.</span><span class="mo">01</span><span class="n">M7D08052020</span>
<span class="n">SASPy</span> <span class="n">Version</span>         <span class="o">=</span> <span class="mf">3.7</span><span class="o">.</span><span class="mi">4</span>
<span class="n">Teach</span> <span class="n">me</span> <span class="n">SAS</span>          <span class="o">=</span> <span class="bp">False</span>
<span class="n">Batch</span>                 <span class="o">=</span> <span class="bp">False</span>
<span class="n">Results</span>               <span class="o">=</span> <span class="n">Pandas</span>
<span class="n">SAS</span> <span class="n">Session</span> <span class="n">Encoding</span>  <span class="o">=</span> <span class="n">latin1</span>
<span class="n">Python</span> <span class="n">Encoding</span> <span class="n">value</span> <span class="o">=</span> <span class="n">latin_1</span>
<span class="n">SAS</span> <span class="n">process</span> <span class="n">Pid</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">21623</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">cars</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">sasdata</span><span class="p">(</span><span class="s1">&#39;cars&#39;</span><span class="p">)</span>
<span class="n">Table</span> <span class="n">WORK</span><span class="o">.</span><span class="n">cars</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span><span class="o">.</span> <span class="n">This</span> <span class="n">SASdata</span> <span class="nb">object</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">useful</span> <span class="n">until</span> <span class="n">the</span> <span class="n">data</span> <span class="nb">set</span> <span class="ow">is</span> <span class="n">created</span><span class="o">.</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="s1">&#39;./saspylogger.log&#39;</span><span class="p">)</span>
<span class="n">SAS</span> <span class="n">Connection</span> <span class="n">established</span><span class="o">.</span> <span class="n">Subprocess</span> <span class="nb">id</span> <span class="ow">is</span> <span class="mi">21595</span>

<span class="n">Table</span> <span class="n">WORK</span><span class="o">.</span><span class="n">cars</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span><span class="o">.</span> <span class="n">This</span> <span class="n">SASdata</span> <span class="nb">object</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">useful</span> <span class="n">until</span> <span class="n">the</span> <span class="n">data</span> <span class="nb">set</span> <span class="ow">is</span> <span class="n">created</span><span class="o">.</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">quit</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="n">SAS</span> <span class="n">Connection</span> <span class="n">terminated</span><span class="o">.</span> <span class="n">Subprocess</span> <span class="nb">id</span> <span class="n">was</span> <span class="mi">21595</span>

<span class="n">tom64</span><span class="o">-</span><span class="mi">5</span><span class="o">&gt;</span> <span class="n">head</span> <span class="n">saspylogger</span><span class="o">.</span><span class="n">log</span>
<span class="n">SAS</span> <span class="n">Connection</span> <span class="n">established</span><span class="o">.</span> <span class="n">Subprocess</span> <span class="nb">id</span> <span class="ow">is</span> <span class="mi">21595</span>

<span class="n">Table</span> <span class="n">WORK</span><span class="o">.</span><span class="n">cars</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span><span class="o">.</span> <span class="n">This</span> <span class="n">SASdata</span> <span class="nb">object</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">useful</span> <span class="n">until</span> <span class="n">the</span> <span class="n">data</span> <span class="nb">set</span> <span class="ow">is</span> <span class="n">created</span><span class="o">.</span>
<span class="n">SAS</span> <span class="n">Connection</span> <span class="n">terminated</span><span class="o">.</span> <span class="n">Subprocess</span> <span class="nb">id</span> <span class="n">was</span> <span class="mi">21595</span>
<span class="n">tom64</span><span class="o">-</span><span class="mi">5</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="sassession-object-as-a-context-manager-as-of-v3-7-5">
<h2>SASsession object as a context manager as of V3.7.5<a class="headerlink" href="#sassession-object-as-a-context-manager-as-of-v3-7-5" title="Permalink to this headline">¶</a></h2>
<p>A user contributed, via PR #401, the ability for a SASsession object to be used as a context manage
for the &#8216;with&#8217; statement (see <a class="reference external" href="https://docs.python.org/3.9/reference/datamodel.html#context-managers">https://docs.python.org/3.9/reference/datamodel.html#context-managers</a>).
This will effectivly issue endsas() upon completion of the with block of code. A convienient way to
clean up if you only want the session around for that block of code. Here&#8217;s an example:</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">saspy</span>
<span class="k">with</span> <span class="n">saspy</span><span class="o">.</span><span class="n">SASsession</span><span class="p">()</span> <span class="k">as</span> <span class="n">sas</span><span class="p">:</span>
  <span class="n">data_in_py</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">sasdata</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="s1">&#39;lib&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
  <span class="c1"># do something with data_in_py</span>
  <span class="c1"># then write it back to sas</span>
  <span class="n">hr</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">df2sd</span><span class="p">(</span><span class="n">data_in_py</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">,</span> <span class="n">libref</span><span class="o">=</span><span class="s2">&quot;lib&quot;</span><span class="p">)</span>

<span class="c1"># do something else in Python (the SASsession object &#39;sas&#39;, has been terminated; sas.endsas() was called)</span>
</pre></div>
</div>
<p>Here&#8217;s a live example showing that the Session was terminated after the with context</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">saspy</span><span class="o">.</span><span class="n">SASsession</span><span class="p">()</span> <span class="k">as</span> <span class="n">sas</span><span class="p">:</span>
<span class="o">...</span>    <span class="n">sas</span><span class="o">.</span><span class="n">sasdata</span><span class="p">(</span><span class="s1">&#39;cars&#39;</span><span class="p">,</span><span class="s1">&#39;sashelp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="o">...</span>    <span class="n">sas</span>
<span class="o">...</span>    <span class="n">sas</span><span class="o">.</span><span class="n">SASpid</span>
<span class="o">...</span>
<span class="n">SAS</span> <span class="n">Connection</span> <span class="n">established</span><span class="o">.</span> <span class="n">Subprocess</span> <span class="nb">id</span> <span class="ow">is</span> <span class="mi">22188</span>

    <span class="n">Make</span>           <span class="n">Model</span>   <span class="n">Type</span> <span class="n">Origin</span> <span class="n">DriveTrain</span>     <span class="n">MSRP</span>  <span class="n">Invoice</span>  <span class="n">EngineSize</span>  <span class="n">Cylinders</span>  <span class="n">Horsepower</span>  <span class="n">MPG_City</span>  <span class="n">MPG_Highway</span>  <span class="n">Weight</span>  <span class="n">Wheelbase</span>  <span class="n">Length</span>
<span class="mi">0</span>  <span class="n">Acura</span>             <span class="n">MDX</span>    <span class="n">SUV</span>   <span class="n">Asia</span>        <span class="n">All</span>  <span class="mf">36945.0</span>  <span class="mf">33337.0</span>         <span class="mf">3.5</span>        <span class="mf">6.0</span>       <span class="mf">265.0</span>      <span class="mf">17.0</span>         <span class="mf">23.0</span>  <span class="mf">4451.0</span>      <span class="mf">106.0</span>   <span class="mf">189.0</span>
<span class="mi">1</span>  <span class="n">Acura</span>  <span class="n">RSX</span> <span class="n">Type</span> <span class="n">S</span> <span class="mi">2</span><span class="n">dr</span>  <span class="n">Sedan</span>   <span class="n">Asia</span>      <span class="n">Front</span>  <span class="mf">23820.0</span>  <span class="mf">21761.0</span>         <span class="mf">2.0</span>        <span class="mf">4.0</span>       <span class="mf">200.0</span>      <span class="mf">24.0</span>         <span class="mf">31.0</span>  <span class="mf">2778.0</span>      <span class="mf">101.0</span>   <span class="mf">172.0</span>
<span class="mi">2</span>  <span class="n">Acura</span>         <span class="n">TSX</span> <span class="mi">4</span><span class="n">dr</span>  <span class="n">Sedan</span>   <span class="n">Asia</span>      <span class="n">Front</span>  <span class="mf">26990.0</span>  <span class="mf">24647.0</span>         <span class="mf">2.4</span>        <span class="mf">4.0</span>       <span class="mf">200.0</span>      <span class="mf">22.0</span>         <span class="mf">29.0</span>  <span class="mf">3230.0</span>      <span class="mf">105.0</span>   <span class="mf">183.0</span>
<span class="mi">3</span>  <span class="n">Acura</span>          <span class="n">TL</span> <span class="mi">4</span><span class="n">dr</span>  <span class="n">Sedan</span>   <span class="n">Asia</span>      <span class="n">Front</span>  <span class="mf">33195.0</span>  <span class="mf">30299.0</span>         <span class="mf">3.2</span>        <span class="mf">6.0</span>       <span class="mf">270.0</span>      <span class="mf">20.0</span>         <span class="mf">28.0</span>  <span class="mf">3575.0</span>      <span class="mf">108.0</span>   <span class="mf">186.0</span>
<span class="mi">4</span>  <span class="n">Acura</span>      <span class="mf">3.5</span> <span class="n">RL</span> <span class="mi">4</span><span class="n">dr</span>  <span class="n">Sedan</span>   <span class="n">Asia</span>      <span class="n">Front</span>  <span class="mf">43755.0</span>  <span class="mf">39014.0</span>         <span class="mf">3.5</span>        <span class="mf">6.0</span>       <span class="mf">225.0</span>      <span class="mf">18.0</span>         <span class="mf">24.0</span>  <span class="mf">3880.0</span>      <span class="mf">115.0</span>   <span class="mf">197.0</span>
<span class="n">Access</span> <span class="n">Method</span>         <span class="o">=</span> <span class="n">STDIO</span>
<span class="n">SAS</span> <span class="n">Config</span> <span class="n">name</span>       <span class="o">=</span> <span class="n">sdssas</span>
<span class="n">SAS</span> <span class="n">Config</span> <span class="nb">file</span>       <span class="o">=</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">tom</span><span class="o">/</span><span class="n">github</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">sascfg_personal</span><span class="o">.</span><span class="n">py</span>
<span class="n">WORK</span> <span class="n">Path</span>             <span class="o">=</span> <span class="o">/</span><span class="n">sastmp</span><span class="o">/</span><span class="n">SAS_workA7A9000056C8_tom64</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span>
<span class="n">SAS</span> <span class="n">Version</span>           <span class="o">=</span> <span class="mf">9.04</span><span class="o">.</span><span class="mo">01</span><span class="n">M7D08052020</span>
<span class="n">SASPy</span> <span class="n">Version</span>         <span class="o">=</span> <span class="mf">3.7</span><span class="o">.</span><span class="mi">4</span>
<span class="n">Teach</span> <span class="n">me</span> <span class="n">SAS</span>          <span class="o">=</span> <span class="bp">False</span>
<span class="n">Batch</span>                 <span class="o">=</span> <span class="bp">False</span>
<span class="n">Results</span>               <span class="o">=</span> <span class="n">Pandas</span>
<span class="n">SAS</span> <span class="n">Session</span> <span class="n">Encoding</span>  <span class="o">=</span> <span class="n">latin1</span>
<span class="n">Python</span> <span class="n">Encoding</span> <span class="n">value</span> <span class="o">=</span> <span class="n">latin_1</span>
<span class="n">SAS</span> <span class="n">process</span> <span class="n">Pid</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">22216</span>


<span class="s1">&#39;22216&#39;</span>

<span class="n">SAS</span> <span class="n">Connection</span> <span class="n">terminated</span><span class="o">.</span> <span class="n">Subprocess</span> <span class="nb">id</span> <span class="n">was</span> <span class="mi">22188</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span><span class="o">.</span><span class="n">SASpid</span> <span class="o">==</span> <span class="bp">None</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sas</span>
<span class="n">Access</span> <span class="n">Method</span>         <span class="o">=</span> <span class="n">STDIO</span>
<span class="n">SAS</span> <span class="n">Config</span> <span class="n">name</span>       <span class="o">=</span> <span class="n">sdssas</span>
<span class="n">SAS</span> <span class="n">Config</span> <span class="nb">file</span>       <span class="o">=</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">tom</span><span class="o">/</span><span class="n">github</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">saspy</span><span class="o">/</span><span class="n">sascfg_personal</span><span class="o">.</span><span class="n">py</span>
<span class="n">WORK</span> <span class="n">Path</span>             <span class="o">=</span> <span class="o">/</span><span class="n">sastmp</span><span class="o">/</span><span class="n">SAS_workA7A9000056C8_tom64</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span>
<span class="n">SAS</span> <span class="n">Version</span>           <span class="o">=</span> <span class="mf">9.04</span><span class="o">.</span><span class="mo">01</span><span class="n">M7D08052020</span>
<span class="n">SASPy</span> <span class="n">Version</span>         <span class="o">=</span> <span class="mf">3.7</span><span class="o">.</span><span class="mi">4</span>
<span class="n">Teach</span> <span class="n">me</span> <span class="n">SAS</span>          <span class="o">=</span> <span class="bp">False</span>
<span class="n">Batch</span>                 <span class="o">=</span> <span class="bp">False</span>
<span class="n">Results</span>               <span class="o">=</span> <span class="n">Pandas</span>
<span class="n">SAS</span> <span class="n">Session</span> <span class="n">Encoding</span>  <span class="o">=</span> <span class="n">latin1</span>
<span class="n">Python</span> <span class="n">Encoding</span> <span class="n">value</span> <span class="o">=</span> <span class="n">latin_1</span>
<span class="n">SAS</span> <span class="n">process</span> <span class="n">Pid</span> <span class="n">value</span> <span class="o">=</span> <span class="bp">None</span>


<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="jupyter-magics">
<h2>Jupyter magics<a class="headerlink" href="#jupyter-magics" title="Permalink to this headline">¶</a></h2>
<p>Jupyter Notebooks have what they call Magics, which let you submit code from a diferent language
than the kernel of the notebook, or provide other functionality. SASPy supports a few magics that
you can use if you are in a Jupyter Notebook. They simply allow you to submit explicit SAS code
from a cell. There is a submitLST() method on the SASsession object which does the same thing as the <code class="docutils literal"><span class="pre">%%SAS</span></code>
magic, and it works in all Python (UIs, IDEs, command prompt, ...) interfaces. So, using it instead
of the magic makes your code run anywhere, not just in a Jupyter notebook, but you can use these if you like.</p>
<p>The magics that are available with the package enable you to bypass Python
and submit programming statements to your SAS session.</p>
<p>The <code class="docutils literal"><span class="pre">%%SAS</span></code> magic enables you to submit the contents of a cell to your SAS
session. The cell magic executes the contents of the cell and returns any
results.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">SAS</span>
<span class="n">proc</span> <span class="nb">print</span> <span class="n">data</span><span class="o">=</span><span class="n">sashelp</span><span class="o">.</span><span class="n">class</span><span class="p">;</span>
<span class="n">run</span><span class="p">;</span>

<span class="n">data</span> <span class="n">work</span><span class="o">.</span><span class="n">a</span><span class="p">;</span>
  <span class="nb">set</span> <span class="n">sashelp</span><span class="o">.</span><span class="n">cars</span><span class="p">;</span>
<span class="n">run</span><span class="p">;</span>
</pre></div>
</div>
<p>If you are also invoking <code class="docutils literal"><span class="pre">saspy</span></code> methods directly in other cells within the
same notebook, you may indicate that a <code class="docutils literal"><span class="pre">%%SAS</span></code> cell should share the same
SAS session by passing your existing session as a parameter.</p>
<p>In a prior cell in the notebook:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">saspy</span>
<span class="n">my_session</span> <span class="o">=</span> <span class="n">saspy</span><span class="o">.</span><span class="n">SASsession</span><span class="p">()</span>

<span class="c1"># sending a dataset to SAS as &#39;mydata&#39;</span>
<span class="n">mydata</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">df2sd</span><span class="p">(</span><span class="n">some_pandas_dataframe</span><span class="p">,</span> <span class="s1">&#39;mydata&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then later, invoke a SAS cell and pass your existing session so that the remote data
set is accessible:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">SAS</span> <span class="n">my_session</span>
<span class="n">proc</span> <span class="nb">print</span> <span class="n">data</span><span class="o">=</span><span class="n">work</span><span class="o">.</span><span class="n">mydata</span><span class="p">;</span>
<span class="n">run</span><span class="p">;</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">%%IML</span></code> magic enables you to submit the contents of a cell to your SAS
session for processing with PROC IML. The cell magic executes the contents
of the cell and returns any results. The PROC IML statement and the trailing
QUIT; statement are submitted automatically.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">IML</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">I</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span> <span class="o">*</span> <span class="mi">6</span><span class="n">x6</span> <span class="n">identity</span> <span class="n">matrix</span><span class="p">;</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">j</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="o">*</span><span class="mi">5</span><span class="n">x5</span> <span class="n">matrix</span> <span class="n">of</span> <span class="mi">0</span><span class="s1">&#39;s;</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">j</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="o">*</span><span class="mi">6</span><span class="n">x1</span> <span class="n">column</span> <span class="n">vector</span> <span class="n">of</span> <span class="mi">1</span><span class="s1">&#39;s;</span>
<span class="n">d</span><span class="o">=</span><span class="n">diag</span><span class="p">({</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span><span class="p">});</span>
<span class="n">e</span><span class="o">=</span><span class="n">diag</span><span class="p">({</span><span class="mi">1</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">});</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">%%OPTMODEL</span></code> magic enables you to submit the contents of a cell to your SAS
session for processing with PROC OPTMODEL. The cell magic executes the contents
of the cell and returns any results. The PROC OPTMODEL statement and the
trailing QUIT; statement are submitted automatically.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">OPTMODEL</span>
<span class="o">/*</span> <span class="n">declare</span> <span class="n">variables</span> <span class="o">*/</span>
<span class="n">var</span> <span class="n">choco</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">toffee</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span>

<span class="o">/*</span> <span class="n">maximize</span> <span class="n">objective</span> <span class="n">function</span> <span class="p">(</span><span class="n">profit</span><span class="p">)</span> <span class="o">*/</span>
<span class="n">maximize</span> <span class="n">profit</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">choco</span> <span class="o">+</span> <span class="mf">0.75</span><span class="o">*</span><span class="n">toffee</span><span class="p">;</span>

<span class="o">/*</span> <span class="n">subject</span> <span class="n">to</span> <span class="n">constraints</span> <span class="o">*/</span>
<span class="n">con</span> <span class="n">process1</span><span class="p">:</span>    <span class="mi">15</span><span class="o">*</span><span class="n">choco</span> <span class="o">+</span><span class="mi">40</span><span class="o">*</span><span class="n">toffee</span> <span class="o">&lt;=</span> <span class="mi">27000</span><span class="p">;</span>
<span class="n">con</span> <span class="n">process2</span><span class="p">:</span>           <span class="mf">56.25</span><span class="o">*</span><span class="n">toffee</span> <span class="o">&lt;=</span> <span class="mi">27000</span><span class="p">;</span>
<span class="n">con</span> <span class="n">process3</span><span class="p">:</span> <span class="mf">18.75</span><span class="o">*</span><span class="n">choco</span>            <span class="o">&lt;=</span> <span class="mi">27000</span><span class="p">;</span>
<span class="n">con</span> <span class="n">process4</span><span class="p">:</span>    <span class="mi">12</span><span class="o">*</span><span class="n">choco</span> <span class="o">+</span><span class="mi">50</span><span class="o">*</span><span class="n">toffee</span> <span class="o">&lt;=</span> <span class="mi">27000</span><span class="p">;</span>
<span class="o">/*</span> <span class="n">solve</span> <span class="n">LP</span> <span class="n">using</span> <span class="n">primal</span> <span class="n">simplex</span> <span class="n">solver</span> <span class="o">*/</span>
<span class="n">solve</span> <span class="k">with</span> <span class="n">lp</span> <span class="o">/</span> <span class="n">solver</span> <span class="o">=</span> <span class="n">primal_spx</span><span class="p">;</span>
<span class="o">/*</span> <span class="n">display</span> <span class="n">solution</span> <span class="o">*/</span>
<span class="nb">print</span> <span class="n">choco</span> <span class="n">toffee</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="adding-procedures.html" class="btn btn-neutral float-right" title="Contributing new methods" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="api.html" class="btn btn-neutral" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018 SAS Institute Inc. All Rights Reserved..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'4.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>